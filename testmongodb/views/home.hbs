<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
  <title>Document</title>
</head>

<body>
  
    <hr>
  <header class=" border-bottom" style="">
    <div class="container-fluid d-grid gap-3 align-items-center" style="grid-template-columns: 1fr 2fr;">
      <div class="dropdown">
        <a href="quanlyip" class="list-group-item list-group-item-action"><img
            src="https://pixlok.com/wp-content/uploads/2021/03/Add-Icon-PNG-Image.jpg" alt="" style="height: 60px;"></a>
      </div>

    </div>
  </header>
  <div class="container-fluid" style="margin-top: 10px; margin-left: 80px;">
    <div class="d-flex gap-1" style="grid-template-columns: 1fr 2fr;">
      <div class="bg-light rounded-3" style="border:  2px solid rebeccapurple; padding: 10px;">
        <form method="GET" action="/search_ip" style="text-align: center;">
          <div class="mb-1">
            <label class="mb-2 text-muted font-weight-bold">tìm kiếm ip </label>
            <input type="text" class="form-control" name="search" style="border: 1px solid red">
          </div>
          <button type="submit">Tìm kiếm</button>
          
        </form>

        <h2 style="text-align: center;">Danh sách ip</h2>
        <div  style="text-align: center;"">
 <a style="text-align: center; font-size: 20px ; font-weight: bold; color: brown;">số lượng ip: {{allip.length}}</a>
        </div>
        
        <div style="height: 400px; overflow-y: scroll; text-align: center;" >
         
          <table border="1" class="table table-striped table-hover">
            <thead>
              <tr style="text-align: center; background-color: rgb(255, 106, 0);">
                <th style="padding: 15px;">Tên Sách</th>
                <th style="padding: 15px;">Hành động</th>
              </tr>
            </thead>
            <tbody>
              {{#each allip}}
              <tr style="text-align: center; background-color: rgb(0, 255, 115);">
                <td style="padding: 15px; font-size: 20px; font-weight: bold; background-color: rgb(55, 168, 194);">
                  {{this.Addressip}}</td>
                <td style="padding: 15px;">
                  <a href="update_ip/{{this._id}}" class="btn btn-primary btn-sm" style="margin-right: 10px;">Sửa</a>
                  <a href="xoa_ip/{{this._id}}" onclick="return confirm('Bạn có chắc chắn muốn xóa?')"
                    class="btn btn-danger btn-sm">Xóa</a>
                </td>
              </tr>
              {{/each}}
            </tbody>
          </table>
        </div>

      </div>

    </div>

  </div>
  <hr>
  <!-- Trong hbs template -->
<div style="height: 50px; overflow-y: scroll; background-color: aqua;">
  <ul style="list-style-type: square; margin-left: 80px;">
    {{#each emails}}
      <li>{{this}}</li>
    {{/each}}
  </ul>
</div>
 <hr>


<div class="button-container">
<form method="POST" action="/updateEmails" class="left-button">
<button onclick="copyText()" type="submit">Copy</button>
</form>
<form method="GET" action="/getEmails" class="right-button">
<button onclick="capnhat()" type="submit">cập nhật</button>
</form>
</div>
<script>
  function capnhat(){
    var copyButton = document.querySelector('.left-button button[type="submit"]');
  copyButton.disabled = false;
  }
function copyText() {
  var copyButton = document.querySelector('.left-button button[type="submit"]');
  copyButton.disabled = true;

 
  var firstEmail =document.querySelector("#email-list li:first-child");
  if (firstEmail) {
    var emailText = firstEmail.textContent;
    navigator.clipboard.writeText(emailText);
    firstEmail.remove();

    // Lấy danh sách email mới và cập nhật lên trang web
    fetch('/getEmails')
      .then(response => response.json())
      .then(data => {
        const emails = data.emails;
        const emailList = document.querySelector('#email-list ul');
        emailList.innerHTML = '';
        emails.forEach(email => {
          const li = document.createElement('li');
          li.textContent = email;
          emailList.appendChild(li);
        });
      })
      .catch(error => console.log(error));
  }
}

</script>


</body>
<style>
  .button-container {
  display: flex;
  text-align: center;
  margin-left: 160px;
}

.left-button {
  margin-right: 10px;
}

.right-button {
  margin-left: 10px;
}

</style>
</html>